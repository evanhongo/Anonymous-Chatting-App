(function(e){function t(t){for(var a,s,u=t[0],o=t[1],i=t[2],b=0,f=[];b<u.length;b++)s=u[b],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&f.push(c[s][0]),c[s]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,i||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,u=1;u<n.length;u++){var o=n[u];0!==c[o]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},c={app:0},r=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],o=u.push.bind(u);u.push=t,u=u.slice();for(var i=0;i<u.length;i++)t(u[i]);var l=o;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"05ee":function(e,t,n){},"0deb":function(e,t,n){"use strict";n("3aaf")},1:function(e,t){},"11cf":function(e,t,n){"use strict";n("e9c6")},2066:function(e,t,n){"use strict";n("e516")},"233d":function(e,t,n){},"3aaf":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("830f"),c=n("5c40"),r=Object(c["D"])("data-v-433ee72a");Object(c["t"])("data-v-433ee72a");var s={id:"app"},u={class:"chat"},o=Object(c["k"])("header",{class:"chat-header"},[Object(c["k"])("label",{class:"menu"},"≡"),Object(c["k"])("span",{class:"name"},"IMatch")],-1),i={key:0,class:"btn btn-lg btn-primary"},l={key:1,class:"btn btn-lg btn-primary"};Object(c["s"])();var b=r((function(e,t){var n=Object(c["v"])("ChatContainer");return Object(c["r"])(),Object(c["g"])("div",s,[Object(c["k"])("div",u,[o,Object(c["k"])(a["a"],{mode:"out-in",name:"fade"},{default:r((function(){return[e.isChatting?Object(c["k"])(n,{key:0}):(Object(c["r"])(),Object(c["g"])("div",{key:1,class:"chat-btn",onClick:t[1]||(t[1]=function(t){return e.handleClick(t)})},[Object(c["k"])(a["a"],{name:"bounce"},{default:r((function(){return[e.isIdle?(Object(c["r"])(),Object(c["g"])("div",i,"開始配對")):(Object(c["r"])(),Object(c["g"])("div",l,"取消配對"))]})),_:1})]))]})),_:1})])])})),f=n("a1e9");function d(e,t){var n=Object(c["v"])("MessageList"),a=Object(c["v"])("MessageForm");return Object(c["r"])(),Object(c["g"])("div",null,[Object(c["k"])(n),Object(c["k"])(a)])}n("a4d3"),n("e01a"),n("99af"),n("d3b7");var v=n("2909"),p=n("d4ec"),O=n("bee2"),j=Symbol(),g=Object(f["g"])({status:"idle",userId:null}),m=Symbol(),h=Object(f["h"])([]);function k(){return new y}var y=function(){function e(){Object(p["a"])(this,e)}return Object(O["a"])(e,[{key:"install",value:function(e){e.provide(j,g),e.provide(m,h)}}]),e}();function w(){var e=Object(c["n"])(j),t=Object(c["f"])((function(){return"idle"===e.status})),n=Object(c["f"])((function(){return"chatting"===e.status}));function a(t){e.status=t}function r(t){e.userId=t}return{config:e,isIdle:t,isChatting:n,setStatus:a,setUserId:r}}function I(){var e=Object(c["n"])(m);function t(t){e.value=t}function n(t){e.value=[].concat(Object(v["a"])(e.value),[t])}function a(){e.value=[]}return{messages:e,initMessage:t,addMessage:n,clearMessage:a}}var M=Object(c["D"])("data-v-48ed9bbc");Object(c["t"])("data-v-48ed9bbc");var x={class:"chat-boxes"},S={ref:"messagesEndRef"};Object(c["s"])();var _=M((function(e,t){var n=Object(c["v"])("Message");return Object(c["r"])(),Object(c["g"])("blockquote",x,[Object(c["k"])(a["b"],{name:"bounceDown"},{default:M((function(){return[(Object(c["r"])(!0),Object(c["g"])(c["c"],null,Object(c["u"])(e.messages,(function(e){return Object(c["r"])(),Object(c["g"])(n,{key:e.id,message:e},null,8,["message"])})),256))]})),_:1}),Object(c["k"])("div",S,null,512)])})),C=(n("96cf"),n("1da1")),P=Object(c["D"])("data-v-bcd7e62a");Object(c["t"])("data-v-bcd7e62a");var R={class:"box"},D=Object(c["k"])("div",null,null,-1);Object(c["s"])();var L=P((function(e,t){return Object(c["r"])(),Object(c["g"])("div",R,[Object(c["k"])("div",{class:["content",e.isMyMessage]},[D,Object(c["j"])(" "+Object(c["y"])(e.message.text),1)],2)])})),F={name:"Message",props:["message"],setup:function(e){var t=w(),n=t.config,a=Object(c["f"])((function(){return{right:e.message.userId===n.userId}}));return{isMyMessage:a}}};n("2066");F.render=L,F.__scopeId="data-v-bcd7e62a";var U=F,V={name:"MessageList",setup:function(){var e=Object(f["h"])(null),t=I(),n=t.messages;return Object(c["p"])((function(){e.value.scrollIntoView({behavior:"smooth"})})),Object(c["B"])(n,function(){var t=Object(C["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["o"])((function(){n&&e.value.scrollIntoView({behavior:"smooth"})}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),{messages:n,messagesEndRef:e}},components:{Message:U}};n("0deb");V.render=_,V.__scopeId="data-v-48ed9bbc";var E=V,J=Object(c["D"])("data-v-f10ee0c6");Object(c["t"])("data-v-f10ee0c6");var T=Object(c["k"])("input",{type:"submit",value:"送出訊息"},null,-1);Object(c["s"])();var q=J((function(e,t){return Object(c["r"])(),Object(c["g"])("form",{class:"chat-footer fixed-bottom",onSubmit:t[3]||(t[3]=Object(a["e"])((function(t){return e.handleSubmit(t)}),["prevent"]))},[Object(c["k"])("input",{type:"button",value:"離開",class:"leave-btn",onClick:t[1]||(t[1]=function(t){return e.handleLeave(t)})}),Object(c["C"])(Object(c["k"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.text=t}),placeholder:"請輸入訊息..."},null,512),[[a["d"],e.text]]),T],32)})),B=n("8055"),z=n.n(B),A=Symbol();function G(e){var t=e.addr;return new H({addr:t})}var H=function(){function e(t){var n=t.addr;Object(p["a"])(this,e),this.socket=z()(n)}return Object(O["a"])(e,[{key:"install",value:function(e){e.provide(A,this.socket)}}]),e}();function K(){var e=Object(c["n"])(A);function t(){var t=w(),n=t.setStatus,a=t.setUserId,c=I(),r=c.initMessage;e.emit("init",localStorage.getItem("userId")),e.on("init",(function(e){if(e.userId)localStorage.setItem("userId",e.userId),a(e.userId);else switch(a(localStorage.getItem("userId")),e.status){case"waiting":n("waiting");break;case"chatting":r(e.messages),n("chatting");break;default:break}})),e.on("waiting",(function(){n("waiting")})),e.on("cancels",(function(){n("idle")})),e.on("matched",(function(){n("chatting")}))}return{socket:e,prepare:t}}var N={name:"MessageForm",setup:function(){var e=Object(f["h"])(""),t=K(),n=t.socket;function a(){return c.apply(this,arguments)}function c(){return c=Object(C["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.emit("message",e.value);case 2:e.value="";case 3:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function r(){n.emit("leaves")}return{text:e,handleSubmit:a,handleLeave:r}}};n("6695");N.render=q,N.__scopeId="data-v-f10ee0c6";var Q=N,W={name:"ChatContainer",setup:function(){var e=w(),t=e.setStatus,n=I(),a=n.addMessage,r=n.clearMessage,s=K(),u=s.socket;return Object(c["p"])((function(){u.on("message",(function(e){a(e)})),u.once("leaves",(function(){u.off("message"),u.off("matcher leaves"),r(),t("idle")})),u.once("matcher leaves",(function(){u.off("message"),u.off("leaves"),r(),t("idle")}))})),{socket:u}},components:{MessageList:E,MessageForm:Q}};W.render=d;var X=W,Y={name:"app",setup:function(){var e=w(),t=e.isIdle,n=e.isChatting,a=K(),r=a.socket,s=a.prepare,u=Object(f["h"])(!0);function o(){t.value?r.emit("waiting"):r.emit("cancels"),u.value=!u.value}return Object(c["p"])((function(){s()})),{isIdle:t,isChatting:n,handleClick:o,bounce:u}},components:{ChatContainer:X}};n("11cf");Y.render=b,Y.__scopeId="data-v-433ee72a";var Z=Y,$=k(),ee=G({addr:"https://anonymous-chatapp.herokuapp.com"});n("233d");Object(a["c"])(Z).use($).use(ee).mount("#app")},6695:function(e,t,n){"use strict";n("05ee")},e516:function(e,t,n){},e9c6:function(e,t,n){}});
//# sourceMappingURL=app.31da888d.js.map